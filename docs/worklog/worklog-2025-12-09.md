# Worklog - December 9, 2025

## Summary
Verified external training migration completed correctly. Documented the post-review process for when management finishes reviewing the 33 T-code groups.

---

## 1. Migration Verification

Confirmed all external training data migrated correctly:
- QOP courses (65 found, 7 missing Parent variants that were intentionally merged)
- QCP courses (none in external data)
- QCD courses - verified for specific employees (e.g., Dillon Adkins)

**Key Finding:** Courses show up under their proper positions, not just MG_ buckets. The MG_ migration only added courses that weren't already linked to an employee's existing positions.

---

## 2. Two Types of Merges - Documentation

### Multi-Variant Groups (33 groups) - NEED MANAGEMENT REVIEW
- T-codes with multiple courses (PARENT, IL, OL variants)
- Example: T654 has 4 variants in external_training
- These appear on the Course Cleanup page (`/course-groups`)
- Management decides: keep all separate, merge some, or delete

### One-to-One Merges - NO REVIEW NEEDED
- T-codes where we just consolidated internal IDs (e.g., 13482 â†’ 999030 for T211)
- Only one course existed in external CSV - no variants to choose between
- Just ID cleanup, no decision needed
- Full history stored in `docs/course-merge-audit-2025-12-04.csv`

---

## 3. Post-Review Plan: Splitting Multi-Variant Groups

If management decides to **split out** courses (e.g., keep all 4 T654 variants separate):

**Current State:**
- Many T-code variants (PARENT, IL, OL, etc.) were merged into single courses
- The `external_training` table still has all original course IDs and records
- Example: T654 has 4 variants in external_training (13693, 13694, 13734, 13887) but only 1 course in our system (13734)

**To Split Back Out:**
1. Create new courses with distinct names (e.g., T654Z1, T654Z2, etc.)
2. The `external_training` table preserves which employees had which specific variant
3. Re-run migration to map old external IDs to new course IDs
4. Add to MG_ buckets based on external_training data

**Why This Works:**
- We never lost the original data - `external_training` is the source of truth
- Each employee's specific variant (IL vs OL vs PARENT) is preserved in external_training
- Can reconstruct the split at any time based on management decisions

### Example: T654 Split

If management decides to keep all 4 T654 variants as separate courses:

**Current State:**
- Only 13734 exists in courses table (others were merged into it)
- external_training has all 4 original IDs: 13693, 13694, 13734, 13887

**Steps:**
1. **Delete merged course** - Remove 13734 (the one everything merged into)
2. **Create 4 new courses** using original IDs with distinct names:
   | ID | New Name |
   |----|----------|
   | 13693 | SPPIVT T654Z1 FAA Employee Drug and Alcohol Training (FedReady) |
   | 13694 | SPPIVT T654Z2 FAA Transferring Employees into/out of Safety Sensitive Positions |
   | 13734 | SPPIVT T654Z3 FAA Supervisor Drug & Alcohol Training |
   | 13887 | SPPIVT T654Z4 FAA Anti-Drug & Alcohol Supervisor Checklist |
3. **Re-run migration** for these courses - external_training knows which employee had which variant
4. **Result:** Each employee's MG_ bucket gets the correct specific course(s) they had in external data

---

## Next Steps
- Manager reviews 33 T-Code groups in Course Cleanup page
- After review, implement split/merge decisions per management direction
