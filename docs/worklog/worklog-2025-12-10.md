# Worklog - December 10, 2025

## Summary
Added Anomalies feature for tracking oddities and issues that need investigation.

---

## 1. Anomalies Feature

### Overview
New feature to track data anomalies, issues, and oddities that need investigation. Users can submit items, add comments, update status, and delete when resolved.

### Database Tables Created

**anomalies**
| Column | Type | Description |
|--------|------|-------------|
| id | SERIAL PK | Auto-increment ID |
| title | VARCHAR(255) | Short title for the anomaly |
| description | TEXT | Detailed description |
| status | VARCHAR(50) | 'open', 'in_progress', or 'resolved' |
| created_at | TIMESTAMP | When created |
| updated_at | TIMESTAMP | Last update time |

**anomaly_comments**
| Column | Type | Description |
|--------|------|-------------|
| id | SERIAL PK | Auto-increment ID |
| anomaly_id | INTEGER FK | References anomalies(id), CASCADE delete |
| comment | TEXT | Comment text |
| created_at | TIMESTAMP | When created |

### API Routes

| Endpoint | Method | Description |
|----------|--------|-------------|
| `/api/anomalies` | GET | List all anomalies with comments |
| `/api/anomalies` | POST | Create new anomaly |
| `/api/anomalies/[id]` | GET | Get single anomaly |
| `/api/anomalies/[id]` | PUT | Update anomaly (title, description, status) |
| `/api/anomalies/[id]` | DELETE | Delete anomaly |
| `/api/anomalies/[id]/comments` | POST | Add comment |
| `/api/anomalies/[id]/comments/[commentId]` | PUT | Edit comment |
| `/api/anomalies/[id]/comments/[commentId]` | DELETE | Delete comment |

### UI Features (`/anomalies`)
- List view with expandable cards
- Status badges (Open=red, In Progress=yellow, Resolved=green)
- Create new anomaly form
- Edit anomaly inline (title, description, status)
- Delete anomaly with confirmation
- Add comments
- Edit comments inline
- Delete comments
- All timestamps displayed in Eastern time

### Files Created
- `scripts/create-anomalies-table.ts` - Database migration script
- `app/api/anomalies/route.ts` - List/Create API
- `app/api/anomalies/[id]/route.ts` - Get/Update/Delete API
- `app/api/anomalies/[id]/comments/route.ts` - Add comment API
- `app/api/anomalies/[id]/comments/[commentId]/route.ts` - Edit/Delete comment API
- `app/anomalies/page.tsx` - UI page

### Sidebar Updates
- Added "Anomalies" link under "Course Cleanup"
- Updated yellow banner: `• Course Cleanup • Anomalies`

### Initial Data
Pre-populated with first anomaly:
- **Title:** T710NF - Duplicate Positions
- **Description:** There are two T710NF positions in the system. Need to investigate which one is correct and potentially merge or remove the duplicate.

---

## Next Steps
- Investigate T710NF duplicate positions issue
- Continue management review of 33 T-Code groups in Course Cleanup
